{"ast":null,"code":"/**\n * This function transforms the feature from reverse geocoding to plain text with specified accuracy\n * @param {object} feature \n * @param {string} accuracy \n * @returns \n */\nfunction transformFeatureToGeolocationText(feature, accuracy) {\n  const addrInfo = getAddressInfo(feature);\n  const addressAccuracy = ['address', 'street', 'place', 'country'];\n  var currentAccuracy;\n\n  if (typeof accuracy === 'function') {\n    return accuracy(addrInfo);\n  }\n\n  const accuracyIndex = addressAccuracy.indexOf(accuracy);\n\n  if (accuracyIndex === -1) {\n    currentAccuracy = addressAccuracy;\n  } else {\n    currentAccuracy = addressAccuracy.slice(accuracyIndex);\n  }\n\n  return currentAccuracy.reduce(function (acc, name) {\n    if (!addrInfo[name]) {\n      return acc;\n    }\n\n    if (acc !== '') {\n      acc = acc + ', ';\n    }\n\n    return acc + addrInfo[name];\n  }, '');\n}\n/**\n * This function transforms the feature from reverse geocoding to AddressInfo object\n * @param {object} feature \n * @returns {object}\n */\n\n\nfunction getAddressInfo(feature) {\n  const houseNumber = feature.address || '';\n  const street = feature.text || '';\n  const placeName = feature.place_name || '';\n  const address = placeName.split(',')[0];\n  const addrInfo = {\n    address: address,\n    houseNumber: houseNumber,\n    street: street,\n    placeName: placeName\n  };\n  feature.context.forEach(function (context) {\n    const layer = context.id.split('.')[0];\n    addrInfo[layer] = context.text;\n  });\n  return addrInfo;\n}\n\nconst REVERSE_GEOCODE_COORD_RGX = /^[ ]*(-?\\d{1,3}(\\.\\d{0,256})?)[, ]+(-?\\d{1,3}(\\.\\d{0,256})?)[ ]*$/;\nmodule.exports = {\n  transformFeatureToGeolocationText: transformFeatureToGeolocationText,\n  getAddressInfo: getAddressInfo,\n  REVERSE_GEOCODE_COORD_RGX: REVERSE_GEOCODE_COORD_RGX\n};","map":{"version":3,"names":["transformFeatureToGeolocationText","feature","accuracy","addrInfo","getAddressInfo","addressAccuracy","currentAccuracy","accuracyIndex","indexOf","slice","reduce","acc","name","houseNumber","address","street","text","placeName","place_name","split","context","forEach","layer","id","REVERSE_GEOCODE_COORD_RGX","module","exports"],"sources":["D:/Github/mobx/multiple-mobx/node_modules/@mapbox/mapbox-gl-geocoder/lib/utils.js"],"sourcesContent":["/**\n * This function transforms the feature from reverse geocoding to plain text with specified accuracy\n * @param {object} feature \n * @param {string} accuracy \n * @returns \n */\nfunction transformFeatureToGeolocationText(feature, accuracy) {\n  const addrInfo = getAddressInfo(feature);\n\n  const addressAccuracy =  ['address', 'street', 'place', 'country'];\n  var currentAccuracy;\n\n  if (typeof accuracy === 'function') {\n    return accuracy(addrInfo)\n  }\n\n  const accuracyIndex = addressAccuracy.indexOf(accuracy);\n\n  if (accuracyIndex === -1) {\n    currentAccuracy = addressAccuracy;\n  } else {\n    currentAccuracy = addressAccuracy.slice(accuracyIndex);\n  }\n\n  return currentAccuracy.reduce(function(acc, name) {\n    if (!addrInfo[name]) {\n      return acc;\n    }\n\n    if (acc !== '') {\n      acc = acc + ', ';\n    }\n\n    return acc + addrInfo[name];\n  }, '');\n}\n/**\n * This function transforms the feature from reverse geocoding to AddressInfo object\n * @param {object} feature \n * @returns {object}\n */\nfunction getAddressInfo(feature) {\n  const houseNumber = feature.address || '';\n  const street = feature.text || '';\n  const placeName = feature.place_name || '';\n  const address = placeName.split(',')[0];\n\n  const addrInfo = {\n    address: address,\n    houseNumber: houseNumber,\n    street: street,\n    placeName: placeName,\n  }\n\n  feature.context.forEach(function (context) {\n    const layer = context.id.split('.')[0];\n    addrInfo[layer] = context.text;\n  });\n\n  return addrInfo;\n}\n\nconst REVERSE_GEOCODE_COORD_RGX = /^[ ]*(-?\\d{1,3}(\\.\\d{0,256})?)[, ]+(-?\\d{1,3}(\\.\\d{0,256})?)[ ]*$/;\n\nmodule.exports = {\n  transformFeatureToGeolocationText: transformFeatureToGeolocationText,\n  getAddressInfo: getAddressInfo,\n  REVERSE_GEOCODE_COORD_RGX: REVERSE_GEOCODE_COORD_RGX,\n}"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA,SAASA,iCAAT,CAA2CC,OAA3C,EAAoDC,QAApD,EAA8D;EAC5D,MAAMC,QAAQ,GAAGC,cAAc,CAACH,OAAD,CAA/B;EAEA,MAAMI,eAAe,GAAI,CAAC,SAAD,EAAY,QAAZ,EAAsB,OAAtB,EAA+B,SAA/B,CAAzB;EACA,IAAIC,eAAJ;;EAEA,IAAI,OAAOJ,QAAP,KAAoB,UAAxB,EAAoC;IAClC,OAAOA,QAAQ,CAACC,QAAD,CAAf;EACD;;EAED,MAAMI,aAAa,GAAGF,eAAe,CAACG,OAAhB,CAAwBN,QAAxB,CAAtB;;EAEA,IAAIK,aAAa,KAAK,CAAC,CAAvB,EAA0B;IACxBD,eAAe,GAAGD,eAAlB;EACD,CAFD,MAEO;IACLC,eAAe,GAAGD,eAAe,CAACI,KAAhB,CAAsBF,aAAtB,CAAlB;EACD;;EAED,OAAOD,eAAe,CAACI,MAAhB,CAAuB,UAASC,GAAT,EAAcC,IAAd,EAAoB;IAChD,IAAI,CAACT,QAAQ,CAACS,IAAD,CAAb,EAAqB;MACnB,OAAOD,GAAP;IACD;;IAED,IAAIA,GAAG,KAAK,EAAZ,EAAgB;MACdA,GAAG,GAAGA,GAAG,GAAG,IAAZ;IACD;;IAED,OAAOA,GAAG,GAAGR,QAAQ,CAACS,IAAD,CAArB;EACD,CAVM,EAUJ,EAVI,CAAP;AAWD;AACD;AACA;AACA;AACA;AACA;;;AACA,SAASR,cAAT,CAAwBH,OAAxB,EAAiC;EAC/B,MAAMY,WAAW,GAAGZ,OAAO,CAACa,OAAR,IAAmB,EAAvC;EACA,MAAMC,MAAM,GAAGd,OAAO,CAACe,IAAR,IAAgB,EAA/B;EACA,MAAMC,SAAS,GAAGhB,OAAO,CAACiB,UAAR,IAAsB,EAAxC;EACA,MAAMJ,OAAO,GAAGG,SAAS,CAACE,KAAV,CAAgB,GAAhB,EAAqB,CAArB,CAAhB;EAEA,MAAMhB,QAAQ,GAAG;IACfW,OAAO,EAAEA,OADM;IAEfD,WAAW,EAAEA,WAFE;IAGfE,MAAM,EAAEA,MAHO;IAIfE,SAAS,EAAEA;EAJI,CAAjB;EAOAhB,OAAO,CAACmB,OAAR,CAAgBC,OAAhB,CAAwB,UAAUD,OAAV,EAAmB;IACzC,MAAME,KAAK,GAAGF,OAAO,CAACG,EAAR,CAAWJ,KAAX,CAAiB,GAAjB,EAAsB,CAAtB,CAAd;IACAhB,QAAQ,CAACmB,KAAD,CAAR,GAAkBF,OAAO,CAACJ,IAA1B;EACD,CAHD;EAKA,OAAOb,QAAP;AACD;;AAED,MAAMqB,yBAAyB,GAAG,mEAAlC;AAEAC,MAAM,CAACC,OAAP,GAAiB;EACf1B,iCAAiC,EAAEA,iCADpB;EAEfI,cAAc,EAAEA,cAFD;EAGfoB,yBAAyB,EAAEA;AAHZ,CAAjB"},"metadata":{},"sourceType":"script"}